(this.webpackJsonptest_sp_tech=this.webpackJsonptest_sp_tech||[]).push([[0],{106:function(e,t,a){e.exports={loginComponent:"Style_loginComponent__2PC20",authInput:"Style_authInput__3i-PH"}},107:function(e,t,a){e.exports={mapBlock:"Style_mapBlock__2XZyT",modalContainer:"Style_modalContainer__26GIM",routeTableData:"Style_routeTableData__MokxS"}},136:function(e,t,a){e.exports={ordersPageTitle:"style_ordersPageTitle__1oWcr"}},142:function(e,t,a){e.exports={mainOrdersTable:"Style_mainOrdersTable__2jYAv"}},144:function(e,t,a){e.exports={loadingComponent:"Style_loadingComponent__2ulQI"}},158:function(e,t,a){},159:function(e,t,a){},251:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a(23),s=a.n(r),c=(a(158),a(24)),o=(a(159),a(25)),i=a.n(o),u=a(44),d=a(88),l=a(26),p=a(78),j=a.n(p),b=function(e){return Object(u.a)(i.a.mark((function t(){var a;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,j.a.post("https://api.demo.cargo-speed.pl/demo/api/v1/login/access_token","grant_type=password&username=".concat(e.username,"&password=").concat(e.password));case 3:return a=t.sent,t.abrupt("return",a);case 7:return t.prev=7,t.t0=t.catch(0),t.abrupt("return",t.t0.response);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()},O=function(){return Object(u.a)(i.a.mark((function e(){var t,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=sessionStorage.accessToken,e.prev=1,e.next=4,j.a.get("https://api.demo.cargo-speed.pl/demo/api/v1/orders/many",{headers:{Authorization:"Bearer ".concat(t)}});case 4:return a=e.sent,e.abrupt("return",a);case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",e.t0.response);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})))()},m=function(e,t){return Object(u.a)(i.a.mark((function a(){var n;return i.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,j.a.get("https://api.openrouteservice.org/v2/directions/driving-car?api_key=5b3ce3597851110001cf6248e866aa5d7899451aa8e13709ccea605c&start=".concat(e.lon,",").concat(e.lat,"&end=").concat(t.lon,",").concat(t.lat));case 3:return n=a.sent,a.abrupt("return",n);case 7:return a.prev=7,a.t0=a.catch(0),a.abrupt("return",a.t0.response);case 10:case"end":return a.stop()}}),a,null,[[0,7]])})))()},f=function(e){return Object(u.a)(i.a.mark((function t(){var a,n,r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.lon,n=e.lat,t.prev=1,t.next=4,j.a.get("https://nominatim.openstreetmap.org/reverse?format=jsonv2&lat=".concat(n,"&lon=").concat(a,"&accept-language=pl"));case 4:return r=t.sent,t.abrupt("return",r);case 8:return t.prev=8,t.t0=t.catch(1),t.abrupt("return",t.t0.response);case 11:case"end":return t.stop()}}),t,null,[[1,8]])})))()},h=a(254),v=a(34),x=a(106),g=a.n(x),y=a(8),_=function(e){var t=e.setIsAuth,a=e.setError,r=e.setIsLoading,s=Object(n.useState)({username:"",password:""}),o=Object(c.a)(s,2),p=o[0],j=o[1],O=function(e){j(Object(l.a)(Object(l.a)({},p),{},Object(d.a)({},e.target.name,e.target.value)))},m=function(){var e=Object(u.a)(i.a.mark((function e(n){var s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),r(!0),e.next=4,b(p);case 4:s=e.sent,r(!1),"4"===s.status.toString()[0]?a((function(e){return Object(l.a)(Object(l.a)({},e),{},{isError:!0,errorMessage:s.data.detail})})):200===s.status&&(a((function(e){return Object(l.a)(Object(l.a)({},e),{},{isError:!1,errorMessage:""})})),sessionStorage.accessToken=s.data.access_token,t(!0));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(y.jsxs)("div",{className:g.a.loginComponent,children:[Object(y.jsx)("h2",{children:"Please Login"}),Object(y.jsx)("div",{children:Object(y.jsxs)("form",{children:[Object(y.jsxs)("label",{children:[" ","Login:",Object(y.jsx)("div",{children:Object(y.jsx)(h.a,{placeholder:"Login",onChange:function(e){return O(e)},name:"username",type:"text",className:g.a.authInput})})]}),Object(y.jsxs)("label",{children:[" ","Password:",Object(y.jsx)("div",{children:Object(y.jsx)(h.a,{placeholder:"Password",onChange:function(e){return O(e)},name:"password",type:"password",className:g.a.authInput})})]}),Object(y.jsx)(v.a,{onClick:function(e){return m(e)},type:"primary",children:"Log in"})]})})]})},k=a(136),w=a.n(k),S=a(255),D=a(107),T=a.n(D),N=a.p+"static/media/Location-512.246403e4.png",I=a(58),C=a.n(I),M=a(253),E=a(65),L=a.n(E),P=a(256),A=function(e){for(var t=e.pointData,a={building:"Zak\u0142ad",house_number:"Nr budynku",road:"Ulica",suburb:"Okolica",city_district:"Dzielnica miasta",city:"Miasto",state:"Wojew\xf3dztwo",postcode:"Kod pocztowy",country:"Kraj",country_code:"Kod kraju",amenity:"Punkt orientacyjny",town:"Miasteczko",county:"Powiat",neighbourhood:"Osiedle",hamlet:"Ma\u0142a wioska",village:"Wie\u015b",municipality:"Gmina"},n=[],r=0,s=Object.entries(t.address);r<s.length;r++){var o=Object(c.a)(s[r],2),i=o[0],u=o[1];n.push({key:Object(P.a)(),addressType:a[i]||i,addressValue:u.toUpperCase()})}var d=[{title:"Address type",dataIndex:"addressType",key:"addressType",className:L.a.addressType},{title:"Value",dataIndex:"addressValue",key:"addressValue"}];return Object(y.jsx)(M.a,{pagination:!1,columns:d,dataSource:n})},Y=function(e){var t=e.pointData;return Object(y.jsxs)("div",{className:L.a.pointTable,children:[Object(y.jsx)("h3",{children:"Final destination:"}),Object(y.jsx)(A,{pointData:t})]})},z=a(100),V=a.n(z),B=function(e){var t=e.pointData;return Object(y.jsxs)("div",{className:L.a.pointTable,children:[Object(y.jsx)("h3",{children:"Start point:"}),Object(y.jsx)(A,{pointData:t})]})},H=function(e){var t=e.isModalVisible,a=e.handleOk,r=e.handleCancel,s=e.routeData,o=e.startPointData,i=e.finalPointData,u=e.orderData,d=Object(c.a)(s.metadata.query.coordinates,2),l=Object(c.a)(d[0],2),p=l[0],j=l[1],b=Object(c.a)(d[1],2),O=b[0],m=b[1];return Object(n.useEffect)((function(){var e=C.a.map("map");C.a.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png?{foo}",{foo:"bar",attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(e);var t=new C.a.LatLng(j,p);e.setView(t,7.5);var a=C.a.icon({iconUrl:N,iconSize:[25,40],iconAnchor:[12,40]});C.a.marker([j,p],{title:"Start point: ".concat(o.display_name)}).addTo(e),C.a.marker([m,O],{icon:a,title:"Final destination: ".concat(i.display_name)}).addTo(e);var n=C.a.geoJson(s,{});e.addLayer(n)}),[]),Object(y.jsx)(y.Fragment,{children:Object(y.jsxs)(S.a,{bodyStyle:{height:"80vh",overflowX:"auto"},title:"Route map. \n                        Order number: ".concat(u.order_number,", \n                        Name: ").concat(u.subject,",\n                        Destination time: ").concat(V()(u.destination.time).format("HH:mm DD.MM.YYYY")),visible:t,onOk:a,onCancel:r,className:T.a.modalContainer,children:[Object(y.jsx)("div",{className:T.a.mapBlock,id:"map"}),Object(y.jsxs)("div",{className:T.a.routeTableData,children:[Object(y.jsx)(B,{pointData:o}),Object(y.jsx)(Y,{pointData:i})]})]})})},F=a(141),W=a(142),J=a.n(W),K=function(e){var t,a=e.orders,n=e.showModal,r=[],s=Object(F.a)(a);try{for(s.s();!(t=s.n()).done;){var c=t.value;r.push({key:Object(P.a)(),orderNr:c.order_number,clientsName:c.subject,destinationTime:V()(c.destination.time).format("HH:mm DD.MM.YYYY"),routeDetails:c})}}catch(i){s.e(i)}finally{s.f()}var o=[{title:"Order nr",dataIndex:"orderNr",key:"orderNr"},{title:"Client name",dataIndex:"clientsName",key:"clientsName"},{title:"Destination time",dataIndex:"destinationTime",key:"destinationTime"},{title:"Route details",dataIndex:"routeDetails",key:"routeDetails",render:function(e){return Object(y.jsx)(v.a,{type:"default",onClick:function(){return n(e)},children:"Show details"})}}];return Object(y.jsx)("div",{className:J.a.mainOrdersTable,children:Object(y.jsx)(M.a,{columns:o,dataSource:r})})},U=a(143),X=a.n(U),q=function(e){var t=e.setError,a=e.setIsLoading,r=(e.isAuth,Object(n.useState)([])),s=Object(c.a)(r,2),o=s[0],d=s[1],p=Object(n.useState)({}),j=Object(c.a)(p,2),b=j[0],h=j[1],v=Object(n.useState)({}),x=Object(c.a)(v,2),g=x[0],_=x[1],k=Object(n.useState)({}),S=Object(c.a)(k,2),D=S[0],T=S[1],N=Object(n.useState)({}),I=Object(c.a)(N,2),C=I[0],M=I[1],E=Object(n.useState)(!1),L=Object(c.a)(E,2),P=L[0],A=L[1];Object(n.useEffect)((function(){var e=function(){var e=Object(u.a)(i.a.mark((function e(){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a(!0),e.next=3,O();case 3:n=e.sent,a(!1),"4"===n.status.toString()[0]?t((function(e){return Object(l.a)(Object(l.a)({},e),{},{isError:!0,errorMessage:n.data.detail})})):200===n.status&&d(n.data);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[]);var Y=function(){var e=Object(u.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(X.a.isEqual(t,b)){e.next=6;break}return a(!0),h((function(e){return Object(l.a)(Object(l.a)({},e),t)})),e.next=5,z(t.source,t.destination);case 5:a(!1);case 6:A(!0);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),z=function(){var e=Object(u.a)(i.a.mark((function e(t,a){var n,r,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m(t,a);case 2:return n=e.sent,e.next=5,f(t);case 5:return r=e.sent,e.next=8,f(a);case 8:s=e.sent,T((function(e){return Object(l.a)(Object(l.a)({},e),r.data)})),M((function(e){return Object(l.a)(Object(l.a)({},e),s.data)})),_((function(e){return Object(l.a)(Object(l.a)({},e),n.data)}));case 12:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}();return Object(y.jsxs)("div",{children:[Object(y.jsxs)("h2",{className:w.a.ordersPageTitle,children:[o.length," - available orders at the moment:"]}),0===o.length?"":Object(y.jsxs)("div",{className:"orders-list",children:[P&&Object(y.jsx)(H,{routeData:g,isModalVisible:P,handleOk:function(){A(!1)},handleCancel:function(){A(!1)},startPointData:D,finalPointData:C,orderData:b}),Object(y.jsx)(K,{orders:o,showModal:Y})]})]})},G=function(e){var t=e.setIsAuth;return Object(y.jsx)("div",{children:Object(y.jsx)(v.a,{type:"primary",onClick:function(e){e.preventDefault(),sessionStorage.clear(),t(!1)},children:"Logout"})})},R=a.p+"static/media/loading.9ca08101.gif",Z=a(144),Q=a.n(Z),$=function(){return Object(y.jsx)("div",{className:Q.a.loadingComponent,children:Object(y.jsx)("img",{src:R,alt:"Loading spinner"})})};var ee=function(){var e=Object(n.useState)(!1),t=Object(c.a)(e,2),a=t[0],r=t[1],s=Object(n.useState)({isError:!1,errorMessage:""}),o=Object(c.a)(s,2),i=o[0],u=o[1],d=Object(n.useState)(!1),l=Object(c.a)(d,2),p=l[0],j=l[1];return Object(n.useEffect)((function(){sessionStorage.accessToken&&r(!0)}),[]),Object(n.useEffect)((function(){i.isError&&(sessionStorage.clear(),r(!1))}),[i.isError]),Object(y.jsxs)("div",{className:"App",children:[Object(y.jsx)("div",{className:"App-bg"}),p&&Object(y.jsx)($,{}),Object(y.jsx)("h1",{children:"Welcome to the order route app!"}),a&&Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)(G,{setIsAuth:r}),Object(y.jsx)(q,{setError:u,setIsLoading:j,isAuth:a})]}),!a&&Object(y.jsx)(_,{setIsAuth:r,setError:u,setIsLoading:j}),i.isError&&Object(y.jsx)("div",{className:"error-message",children:i.errorMessage})]})};s.a.render(Object(y.jsx)(ee,{}),document.getElementById("root"))},65:function(e,t,a){e.exports={pointTable:"Style_pointTable__3fP1X",addressType:"Style_addressType__1m2Y3"}}},[[251,1,2]]]);
//# sourceMappingURL=main.83999ed9.chunk.js.map